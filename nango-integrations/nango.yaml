integrations:
    outlook:
        actions:
            list-users:
                description: |
                    List all users in the Microsoft 365 tenant.
                    Used to discover mailboxes to sync.
                output: User[]
                endpoint:
                    method: GET
                    path: /list-users
                    group: Users
                scopes: User.Read.All
            
            sync-mailbox:
                description: |
                    Sync a user's mailbox using delta API for incremental sync.
                    Returns new/updated messages since last sync.
                input: UserId
                output: Message[]
                endpoint:
                    method: GET
                    path: /sync-mailbox
                    group: Mail
                scopes: Mail.Read Mail.ReadBasic

    google-drive:
        syncs:
            all-files:
                description: |
                    Syncs ALL files from Google Drive (auto-runs every hour).
                    Returns metadata only - use fetch-document action to download content.
                runs: every hour
                output: DriveFile
                sync_type: incremental
                endpoint:
                    method: GET
                    path: /all-files
                    group: Documents
                scopes: https://www.googleapis.com/auth/drive.readonly
        actions:
            fetch-document:
                input: IdEntity
                description: |
                    Fetches the content of a file given its ID and returns it as base64.
                    For Google Workspace files (Docs, Sheets, Slides), these are exported to PDF/Excel format.
                    Use this to download PDFs, Word docs, images, and any other file from Drive.
                output: string
                version: 1.0.0
                endpoint:
                    method: GET
                    path: /fetch-document
                    group: Documents
                scopes: https://www.googleapis.com/auth/drive.readonly

models:
    IdEntity:
        id: string
    
    UserId:
        userId: string
    
    User:
        id: string
        userPrincipalName: string
        displayName: string | undefined
    
    Message:
        id: string
        subject: string | undefined
        from: EmailAddress
        toRecipients: EmailAddress[]
        receivedDateTime: string
        webLink: string | undefined
        body: MessageBody
        changeKey: string
    
    EmailAddress:
        name: string | undefined
        address: string
    
    MessageBody:
        contentType: string
        content: string
    
    DriveFile:
        id: string
        name: string
        mimeType: string
        webViewLink: string | undefined
        parents: string[] | undefined
        modifiedTime: string
        createdTime: string
        size: number | undefined
        trashed: boolean
