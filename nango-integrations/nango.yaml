integrations:
    outlook:
        syncs:
            emails:
                description: |
                    üîç V14 ENHANCED DEBUGGING - Added detailed attachment detection logging!
                    Logs hasAttachments flag, CID references in body, Graph API responses, attachment details.
                    Now with better error handling and endpoint debugging. Mail.ReadWrite scope for attachment access.
                    Uses Exchange FullAccess delegation. Default lookback is 1 week (configurable via backfillPeriodMs metadata).
                runs: every hour
                output: OutlookEmail
                sync_type: incremental
                endpoint:
                    method: GET
                    path: /emails
                    group: Mail
                scopes: offline_access Mail.ReadWrite Mail.Read.Shared User.Read

    # google-drive:
    #     syncs:
    #         all-files:
    #             description: |
    #                 Syncs ALL files from Google Drive (auto-runs every hour).
    #                 Returns metadata only - use fetch-document action to download content.
    #             runs: every hour
    #             output: DriveFile
    #             sync_type: incremental
    #             endpoint:
    #                 method: GET
    #                 path: /all-files
    #                 group: Documents
    #             scopes: https://www.googleapis.com/auth/drive.readonly
    #     actions:
    #         fetch-document:
    #             input: IdEntity
    #             description: |
    #                 Fetches the content of a file given its ID and returns it as base64.
    #                 For Google Workspace files (Docs, Sheets, Slides), these are exported to PDF/Excel format.
    #                 Use this to download PDFs, Word docs, images, and any other file from Drive.
    #             output: string
    #             version: 1.0.0
    #             endpoint:
    #                 method: GET
    #                 path: /fetch-document
    #                 group: Documents
    #             scopes: https://www.googleapis.com/auth/drive.readonly

models:
    IdEntity:
        id: string
    
    Attachments:
        filename: string
        mimeType: string
        size: number
        attachmentId: string
    
    OutlookEmail:
        id: string
        sender: string | undefined
        recipients: string | undefined
        date: string
        subject: string
        body: string
        attachments: Attachments[]
        threadId: string
    
    DriveFile:
        id: string
        name: string
        mimeType: string
        webViewLink: string | undefined
        parents: string[] | undefined
        modifiedTime: string
        createdTime: string
        size: number | undefined
        trashed: boolean
